webpackJsonp([1],{"+vOg":function(e,t,a){"use strict";a.d(t,"b",function(){return i}),a.d(t,"a",function(){return o});var r=a("Vjoj"),n=a("P7rh"),s=a("g0X3"),i=a("DmT9")(""),o=r();o.configure(n({storage:window.localStorage})).configure(s(i,{timeout:2e4}))},0:function(e,t){},"2d5O":function(e,t){},"7Ts1":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={name:"admin",data:function(){return{dialog:!1,drawer:null,items:[{icon:"supervisor_account",text:"Employees",url:"Employees"}]}},computed:{employeesListView:function(){return this.$store.getters["user/GET_EMPLOYEES_LIST_VIEW"]}},methods:{changeEmployeesView:function(){var e="grid"===this.employeesListView?"list":"grid";this.$store.commit("user/SET_EMPLOYEES_LIST_VIEW",e)}},props:{source:String}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-navigation-drawer",{attrs:{fixed:"",clipped:e.$vuetify.breakpoint.mdAndUp,app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("v-list",{attrs:{dense:""}},[e._l(e.items,function(t){return[t.heading?a("v-layout",{key:t.heading,attrs:{row:"","align-center":""}},[a("v-flex",{attrs:{xs6:""}},[t.heading?a("v-subheader",[e._v("\n\t\t\t\t\t\t\t"+e._s(t.heading)+"\n\t\t\t\t\t\t")]):e._e()],1),e._v(" "),a("v-flex",{staticClass:"text-xs-center",attrs:{xs6:""}},[a("a",{staticClass:"body-2 black--text",attrs:{href:"#!"}},[e._v("EDIT")])])],1):t.children?a("v-list-group",{key:t.text,attrs:{"prepend-icon":t.model?t.icon:t["icon-alt"],"append-icon":""},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}},[a("v-list-tile",{attrs:{slot:"activator"},slot:"activator"},[a("v-list-tile-content",[a("v-list-tile-title",[e._v("\n\t\t\t\t\t\t\t\t"+e._s(t.text)+"\n\t\t\t\t\t\t\t")])],1)],1),e._v(" "),e._l(t.children,function(t,r){return a("v-list-tile",{key:r},[t.icon?a("v-list-tile-action",[a("v-icon",[e._v(e._s(t.icon))])],1):e._e(),e._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[e._v("\n\t\t\t\t\t\t\t\t"+e._s(t.text)+"\n\t\t\t\t\t\t\t")])],1)],1)})],2):a("v-list-tile",{key:t.text,attrs:{to:{name:t.url},ripple:""}},[a("v-list-tile-action",[a("v-icon",[e._v(e._s(t.icon))])],1),e._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[e._v("\n\t\t\t\t\t\t\t"+e._s(t.text)+"\n\t\t\t\t\t\t")])],1)],1)]})],2)],1),e._v(" "),a("v-toolbar",{attrs:{color:"blue darken-3",dark:"",app:"","clipped-left":e.$vuetify.breakpoint.mdAndUp,fixed:""}},[a("v-toolbar-title",{staticClass:"ml-0 pl-3",staticStyle:{width:"300px"}},[a("v-toolbar-side-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),e._v(" "),a("span",{staticClass:"hidden-sm-and-down"},[e._v("SSO Management")])],1),e._v(" "),a("v-text-field",{staticClass:"hidden-sm-and-down",attrs:{flat:"","solo-inverted":"","prepend-icon":"search",label:"Search"}}),e._v(" "),a("v-spacer"),e._v(" "),a("v-btn",{attrs:{icon:""},on:{click:e.changeEmployeesView}},["list"===e.employeesListView?a("v-icon",[e._v("apps")]):"grid"===e.employeesListView?a("v-icon",[e._v("list")]):e._e()],1)],1),e._v(" "),a("v-content",[a("v-container",{attrs:{fluid:""}},[a("router-view")],1)],1)],1)},staticRenderFns:[]},s=a("VU/8")(r,n,!1,null,null,null);t.default=s.exports},"7Ulu":function(e,t,a){e.exports=a.p+"static/img/sso-logo.8c053f4.svg"},"7zck":function(e,t){},"9pCX":function(e,t){},DmgS:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),s=a("Dd8w"),i=a.n(s),o=a("exGp"),l=a.n(o),c=a("7+uW"),d=a("/ocq"),u=a("//Fk"),v=a.n(u),f=a("+vOg"),p=a("BcvJ"),m={data:function(){return{valid:!0,idNumber:null,password:null,idNumberRules:[function(e){return!!e||"Enter your ID number"}],passwordRules:[function(e){return!!e||"Enter your password"}],color:"#1565C0",authError:!1,icon:!0,loading:!1}},methods:{submit:function(){var e=this;return l()(n.a.mark(function t(){var a,r,s,i,o,l;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.idNumber&&e.password){t.next=3;break}return e.$snotify.error("ID number and password are required"),t.abrupt("return");case 3:return(a=new p).is().min(10).is().max(100).has().uppercase().has().lowercase().has().digits(1).has().not().spaces().has().symbols().is().not().oneOf(["Passw0rd","Password123","P@ssw0rd123"]),r=a.validate(e.password),console.log("isPasswordValid",r),e.loading=!0,t.prev=8,t.next=11,new v.a(function(e){return setTimeout(e,3e3)});case 11:return t.next=13,e.attemptLogin();case 13:if(s=t.sent,i=s.userId,o=s.userData,r){t.next=22;break}return t.next=19,f.a.service("users").patch(i,{requirePasswordChange:!0});case 19:e.$store.commit("account/SET_REQUIRE_PASSWORD_CHANGE",!0),t.next=25;break;case 22:return t.next=24,f.a.service("users").patch(i,{requirePasswordChange:!1});case 24:e.$store.commit("account/SET_REQUIRE_PASSWORD_CHANGE",!1);case 25:if(!(l=e.$route.query.referer)){t.next=29;break}return location.replace(l),t.abrupt("return");case 29:if(!(o.roles&&o.roles.sso&&o.roles.sso.includes("admin"))){t.next=42;break}if(r){t.next=36;break}return t.next=33,f.a.service("users").patch(i,{requirePasswordChange:!0});case 33:e.$store.commit("account/SET_REQUIRE_PASSWORD_CHANGE",!0),t.next=39;break;case 36:return t.next=38,f.a.service("users").patch(i,{requirePasswordChange:!1});case 38:e.$store.commit("account/SET_REQUIRE_PASSWORD_CHANGE",!1);case 39:e.$router.push({name:"Employees"}),t.next=43;break;case 42:e.$router.push({name:"Profile"});case 43:t.next=49;break;case 45:t.prev=45,t.t0=t.catch(8),e.$snotify.error("Invalid credentials"),console.error("ERROR!",t.t0);case 49:return t.prev=49,e.loading=!1,t.finish(49);case 52:case"end":return t.stop()}},t,e,[[8,45,49,52]])}))()},attemptLogin:function(){var e=this;return l()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=3,r=1;case 2:if(!(r<=a)){t.next=18;break}if(t.prev=3,!(r>1)){t.next=7;break}return t.next=7,new v.a(function(e){return setTimeout(e,4e3)});case 7:return t.next=9,e.$store.dispatch("account/LOGIN",{idNumber:e.idNumber,password:e.password});case 9:return t.abrupt("return",t.sent);case 12:t.prev=12,t.t0=t.catch(3),console.error("Login attempt "+r+" failed:",t.t0);case 15:r++,t.next=2;break;case 18:throw new Error("Max login attempts ("+a+") reached.");case 19:case"end":return t.stop()}},t,e,[[3,12]])}))()}}},_={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-container"},[r("v-container",[r("v-layout",{attrs:{wrap:""}},[r("v-flex",{attrs:{sm12:"",md6:"","offset-md3":""}},[r("v-card",{staticClass:"transparent-card",attrs:{elevation:"4",light:"",tag:"section"}},[r("v-card-title",[r("v-layout",{attrs:{"align-center":"","justify-center":""}},[r("img",{attrs:{width:"250",src:a("7Ulu")}})])],1),e._v(" "),r("v-divider"),e._v(" "),r("v-card-text",[r("p",[e._v("Sign in with ID number and Password")]),e._v(" "),r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("p",{directives:[{name:"show",rawName:"v-show",value:e.authError,expression:"authError"}],staticClass:"red--text text--darken-1"},[e._v("\n                  ID number or password is incorrect.\n                ")]),e._v(" "),r("v-text-field",{attrs:{outline:"",label:"ID Number",type:"text",rules:e.idNumberRules,required:""},model:{value:e.idNumber,callback:function(t){e.idNumber=t},expression:"idNumber"}}),e._v(" "),r("v-text-field",{attrs:{outline:"","hide-details":"",label:"Password",type:"password",required:"",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e._v(" "),r("v-divider"),e._v(" "),r("v-card-actions",{class:{"pa-3":e.$vuetify.breakpoint.smAndUp}},[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{loading:e.loading,disabled:e.loading,color:"info",large:e.$vuetify.breakpoint.smAndUp},on:{click:e.submit}},[r("v-icon",{attrs:{left:""}},[e._v("lock")]),e._v("\n                Login\n              ")],1),e._v(" "),r("v-spacer")],1),e._v(" "),r("v-card-actions",[r("v-layout",{attrs:{"align-center":"","justify-space-between":""}},[r("p",{staticClass:"caption my-3"},[r("a",{attrs:{href:"http://10.10.120.5/mirdcintranet/images/Policies/Administrative/POL-MIRDC-023.Rev0_Access-control-Guidelines.pdf",target:"_blank"}},[e._v("Policy Manual")])]),e._v(" "),r("p",{staticClass:"caption my-3"},[e._v("Powered by "),r("a",{attrs:{href:"http://10.10.120.19:6969/"}},[e._v("PMD-MIS")])])])],1)],1)],1)],1)],1),e._v(" "),r("vue-snotify")],1)},staticRenderFns:[]};var h=a("VU/8")(m,_,!1,function(e){a("9pCX")},"data-v-196b44c8",null).exports,x=a("mvHQ"),g=a.n(x),w=a("fZjL"),b=a.n(w);function y(e){return new v.a(function(t,a){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){console.log(this),t(r.result)},r.onerror=function(e){a(e)}})}function E(e){return new v.a(function(t){var a=new Image;a.onload=function(){var e=document.createElement("canvas");e.width=this.naturalWidth,e.height=this.naturalHeight,e.getContext("2d").drawImage(this,0,0),t({data:e.toDataURL("image/png"),width:e.width,height:e.height})},a.src=e})}function k(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300,n=Math.min(a/e,r/t);return{width:e*n,height:t*n}}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new v.a(function(r){var n=document.createElement("img");n.onload=function(){var e=document.createElement("canvas"),n=e.getContext("2d");t&&a?(e.width=t,e.height=a,n.drawImage(this,0,0,t,a)):(e.width=this.width,e.height=this.height,n.drawImage(this,0,0,this.width,this.height)),r(e.toDataURL())},n.crossOrigin="anonymous",n.src=e})}var D={props:{loaderDialog:Boolean}},P={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:e.loaderDialog,callback:function(t){e.loaderDialog=t},expression:"loaderDialog"}},[a("v-card",{attrs:{color:"primary",dark:""}},[a("v-card-text",[e._v("\n\t\t\tPlease stand by\n\t\t\t"),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)},staticRenderFns:[]},T=a("VU/8")(D,P,!1,null,null,null).exports,$={data:function(){return{divisions:[],sections:[],editLayout:!1,search:null,loading:!1,rowsPerPage:[10,20,35,{text:"$vuetify.dataIterator.rowsPerPageAll",value:-1}],headers:[{text:"ID number",align:"left",value:"emp_id"},{text:"First name",value:"personal_information.first_name"},{text:"Middle name",value:"personal_information.middle_name"},{text:"Surname",value:"personal_information.surname"},{text:"Appointment",value:"extra_information.appointment"},{text:"Division",value:"extra_information.division.text"},{text:"Actions",value:"_id",sortable:!1}],valid:!0,infoDialog:!1,infoDialogTitle:null,rolesRules:[function(e){return e&&function(e){try{var t=JSON.parse(e);return b()(t).length>0}catch(e){return!1}}(e)||"Invalid string. Data can't be parsed."}],roles:null,loaderDialog:!1,selectedItem:{}}},created:function(){var e=this;return l()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$store.dispatch("employee/GET_EMPLOYEES");case 3:e.loading=!1;case 4:case"end":return t.stop()}},t,e)}))()},methods:{fetchDivisions:function(){var e=this;return l()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("division/GET_DIVISIONS");case 2:a=t.sent,e.divisions=a.map(function(e){return{text:e.name,sections:e.sections.map(function(e){return{text:e.name,value:e.name}}),value:e.name}}),e.selectedItem.extra_information&&e.selectedItem.extra_information.division&&(r=e.divisions.filter(function(t){return t.text===e.selectedItem.extra_information.division.text}),e.sections=r[0].sections,console.log(r.sections));case 5:case"end":return t.stop()}},t,e)}))()},editDialog:function(e){this.fetchDivisions(),this.roles=null,this.editLayout=!0,this.selectedItem=e},updateProfile:function(){f.a.service("users").patch(this.selectedItem._id,this.selectedItem),this.$snotify.success("Has been successfully updated")},openInfoDialog:function(e){var t=this;this.roles=null,this.selectedItem=e,f.a.service("users").get(e._id).then(function(e){t.loaderDialog=!1,e.roles&&(t.roles=g()(e.roles)),t.infoDialogTitle="Roles",t.infoDialog=!0})},saveRoles:function(){this.saveInformation("roles",this.roles)},saveInformation:function(e,t){var a=this;this.$refs.form.validate()&&("roles"===e&&(t=JSON.parse(t)),this.loaderDialog=!0,this.$store.dispatch("account/UPDATE_INFORMATION",{field:e,data:t,userId:this.selectedItem._id}).then(function(e){a.loaderDialog=!1,a.$snotify.success("Roles has been successfully updated")}).catch(function(e){console.log(e),a.loaderDialog=!1,a.$snotify.error("An error occurred")}))},fetchInformation:function(e){return f.a.service("users").get(e)},resetPassword:function(e,t){var a=this;return l()(n.a.mark(function r(){return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,confirm("Are you sure?")){r.next=4;break}return r.abrupt("return");case 4:return a.loaderDialog=!0,e.length<=4&&(e="mirdc"+e),r.next=8,a.$store.dispatch("account/UPDATE_INFORMATION",{field:"password",data:e,userId:t});case 8:r.sent,a.loaderDialog=!1,a.$snotify.success("Password has been successfully updated"),r.next=18;break;case 13:r.prev=13,r.t0=r.catch(0),a.loaderDialog=!1,a.$snotify.error("An error occurred"),console.log(r.t0);case 18:case"end":return r.stop()}},r,a,[[0,13]])}))()},deleteUser:function(e){var t=this;return l()(n.a.mark(function a(){return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,confirm("Are you sure you want to delete?")){a.next=4;break}return a.abrupt("return");case 4:t.loaderDialog=!0,f.a.service("users").remove(e),t.loaderDialog=!1,t.$snotify.success("User has been successfully delete"),a.next=15;break;case 10:a.prev=10,a.t0=a.catch(0),t.loaderDialog=!1,t.$snotify.error("An error occurred"),console.log(a.t0);case 15:case"end":return a.stop()}},a,t,[[0,10]])}))()}},watch:{roles:function(e){try{e&&(this.roles=g()(JSON.parse(e),null,2))}catch(e){}}},components:{LoaderDialog:T},computed:{items:function(){return this.$store.state.employee.list}}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:"",xl9:""}},[a("v-card",[a("v-card-title",[a("div",{staticClass:"headline"},[e._v("Employees")]),e._v(" "),a("v-spacer"),e._v(" "),a("v-text-field",{attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),a("v-data-table",{attrs:{"disable-initial-sort":"",headers:e.headers,items:e.items,search:e.search,loading:e.loading,"rows-per-page-items":e.rowsPerPage},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",{attrs:{slot:"activator"},slot:"activator"},[a("td",[e._v(e._s(t.item.emp_id))]),e._v(" "),a("td",[e._v(e._s(t.item.personal_information.first_name))]),e._v(" "),a("td",[e._v(e._s(t.item.personal_information.middle_name))]),e._v(" "),a("td",[e._v(e._s(t.item.personal_information.surname))]),e._v(" "),a("td",[e._v(e._s(t.item.extra_information.appointment))]),e._v(" "),a("td",[e._v(e._s(t.item.extra_information.division.text))]),e._v(" "),a("td",[a("v-menu",{attrs:{bottom:"",left:""}},[a("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[a("v-icon",[e._v("more_vert")])],1),e._v(" "),a("v-card",[a("v-card-title",[a("div",{staticClass:"title"},[e._v("Update information")])]),e._v(" "),a("v-list",[a("v-list-tile",{attrs:{ripple:""},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.editDialog(t.item)}}},[a("v-list-tile-title",[e._v("Edit Profile")])],1),e._v(" "),a("v-list-tile",{attrs:{ripple:""},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.openInfoDialog(t.item)}}},[a("v-list-tile-title",[e._v("Roles")])],1),e._v(" "),a("v-list-tile",{attrs:{ripple:""},on:{click:function(a){return e.resetPassword(t.item.emp_id,t.item._id)}}},[a("v-list-tile-title",[e._v("Reset Password")])],1),e._v(" "),a("v-list-tile",{attrs:{ripple:""},on:{click:function(a){return e.deleteUser(t.item._id)}}},[a("v-list-tile-title",[e._v("Delete User")])],1)],1)],1)],1)],1)])]}}])},[e._v(" "),a("v-alert",{attrs:{slot:"no-results",value:!0,color:"error",icon:"warning"},slot:"no-results"},[e._v('\n\t\t\t\t\t\t\tYour search for "'+e._s(e.search)+'" found no results.\n\t\t\t\t\t\t')])],1)],1)],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"490"},model:{value:e.infoDialog,callback:function(t){e.infoDialog=t},expression:"infoDialog"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("div",{staticClass:"headline white--text"},[e._v(e._s(e.infoDialogTitle))])]),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-textarea",{attrs:{rules:e.rolesRules,rows:"15"},model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}})],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"grey darken-1",flat:""},nativeOn:{click:function(t){e.infoDialog=!1}}},[e._v("Close")]),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:e.saveRoles}},[e._v("Save")])],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"490"},model:{value:e.editLayout,callback:function(t){e.editLayout=t},expression:"editLayout"}},[a("v-card",[a("v-card-title",{staticClass:"primary"},[a("div",{staticClass:"headline white--text"},[e._v("Edit Profile")])]),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.selectedItem.personal_information?a("v-text-field",{attrs:{label:"First Name"},model:{value:e.selectedItem.personal_information.first_name,callback:function(t){e.$set(e.selectedItem.personal_information,"first_name",t)},expression:"selectedItem.personal_information.first_name"}}):e._e(),e._v(" "),e.selectedItem.personal_information?a("v-text-field",{attrs:{label:"Middle Name"},model:{value:e.selectedItem.personal_information.middle_name,callback:function(t){e.$set(e.selectedItem.personal_information,"middle_name",t)},expression:"selectedItem.personal_information.middle_name"}}):e._e(),e._v(" "),e.selectedItem.personal_information?a("v-text-field",{attrs:{label:"Last Name"},model:{value:e.selectedItem.personal_information.surname,callback:function(t){e.$set(e.selectedItem.personal_information,"surname",t)},expression:"selectedItem.personal_information.surname"}}):e._e(),e._v(" "),a("v-text-field",{attrs:{label:"Employee ID"},model:{value:e.selectedItem.emp_id,callback:function(t){e.$set(e.selectedItem,"emp_id",t)},expression:"selectedItem.emp_id"}}),e._v(" "),e.selectedItem.personal_information?a("v-text-field",{attrs:{label:"Email Address"},model:{value:e.selectedItem.personal_information.email,callback:function(t){e.$set(e.selectedItem.personal_information,"email",t)},expression:"selectedItem.personal_information.email"}}):e._e(),e._v(" "),e.selectedItem.personal_information?a("v-select",{attrs:{items:e.divisions,label:"Select","item-text":"text","item-value":"value","return-object":""},on:{input:e.fetchDivisions},model:{value:e.selectedItem.extra_information.division,callback:function(t){e.$set(e.selectedItem.extra_information,"division",t)},expression:"selectedItem.extra_information.division"}}):e._e(),e._v(" "),e.selectedItem.personal_information?a("v-select",{attrs:{items:e.sections,label:"Select","item-text":"text","item-value":"value","return-object":""},model:{value:e.selectedItem.extra_information.section,callback:function(t){e.$set(e.selectedItem.extra_information,"section",t)},expression:"selectedItem.extra_information.section"}}):e._e(),e._v(" "),e.selectedItem.personal_information?a("v-text-field",{attrs:{label:"Position"},model:{value:e.selectedItem.extra_information.position,callback:function(t){e.$set(e.selectedItem.extra_information,"position",t)},expression:"selectedItem.extra_information.position"}}):e._e()],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"grey darken-1",flat:""},nativeOn:{click:function(t){e.editLayout=!1}}},[e._v("Close")]),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:e.updateProfile}},[e._v("Save")])],1)],1)],1),e._v(" "),a("LoaderDialog",{attrs:{loaderDialog:e.loaderDialog}}),e._v(" "),a("vue-snotify")],1)},staticRenderFns:[]},O=a("VU/8")($,S,!1,null,null,null).exports,A=a("woOf"),N=a.n(A),C={props:{data:Object,title:String,flat:Boolean},data:function(){return{valid:!0,rules:[function(e){return!!e||"This field is required"}],emailRules:[function(e){return!!e||"This field is required"},function(e){return/.+@.+/.test(e)||"E-mail must be valid"}]}},methods:{validateFields:function(){this.$emit("personalInfoValid",this.$refs.form.validate())},resetValidation:function(){this.$refs.form.resetValidation()}}},R={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{attrs:{flat:e.flat}},[e.title?a("v-card-title",[a("div",{staticClass:"headline"},[e._v(e._s(e.title))]),e._v(" "),a("v-spacer")],1):e._e(),e._v(" "),e.title?a("v-divider"):e._e(),e._v(" "),a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("First name")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{required:"",rules:e.rules},model:{value:e.data.first_name,callback:function(t){e.$set(e.data,"first_name",t)},expression:"data.first_name"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Middle name")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{required:"",rules:e.rules},model:{value:e.data.middle_name,callback:function(t){e.$set(e.data,"middle_name",t)},expression:"data.middle_name"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Last name")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{required:"",rules:e.rules},model:{value:e.data.surname,callback:function(t){e.$set(e.data,"surname",t)},expression:"data.surname"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Extension")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{model:{value:e.data.name_extension,callback:function(t){e.$set(e.data,"name_extension",t)},expression:"data.name_extension"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Email address")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{required:"",rules:e.emailRules},model:{value:e.data.email,callback:function(t){e.$set(e.data,"email",t)},expression:"data.email"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Birthday")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{directives:[{name:"mask",rawName:"v-mask",value:"####-##-##",expression:"'####-##-##'"}],attrs:{required:"",rules:e.rules},model:{value:e.data.birthday,callback:function(t){e.$set(e.data,"birthday",t)},expression:"data.birthday"}})],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},L=a("VU/8")(C,R,!1,null,null,null).exports,U=a("NYxO"),M={data:function(){return{loading:!1,personal_information:{},loaderDialog:!1}},created:function(){this.personal_information=N()({},this.employee_data.personal_information)},methods:{save:function(){var e=this;this.loaderDialog=!0,this.$store.dispatch("account/UPDATE_INFORMATION",{field:"personal_information",data:this.personal_information}).then(function(t){e.loaderDialog=!1,e.$snotify.success("Personal information updated")}).catch(function(t){console.log(t),e.loaderDialog=!1,e.$snotify.error("An error occurred")})}},computed:i()({},Object(U.b)({employee_data:"account/GET_EMPLOYEE_DATA"})),components:{PersonalInformation:L,LoaderDialog:T}},q={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:"",xl9:""}},[a("v-card",[a("PersonalInformation",{ref:"personalInfo",attrs:{data:e.personal_information,flat:!0,title:"Personal Information"},on:{personalInfoValid:function(t){return t?e.save():null}}}),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.$refs.personalInfo.validateFields()}}},[e._v("Save")])],1)],1)],1)],1)],1),e._v(" "),a("LoaderDialog",{attrs:{loaderDialog:e.loaderDialog}}),e._v(" "),a("vue-snotify")],1)},staticRenderFns:[]};var V=a("VU/8")(M,q,!1,function(e){a("cL48")},"data-v-29f30a94",null).exports,F={props:{data:Object,title:String,flat:Boolean,idNumberField:Boolean},created:function(){this.fetchDivisions()},data:function(){return{divisions:[],sections:[],valid:!0,rules:[function(e){return!!e||"This field is required"}]}},methods:{fetchDivisions:function(){var e=this;return l()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("division/GET_DIVISIONS");case 2:a=t.sent,e.divisions=a.map(function(e){return{text:e.name,sections:e.sections.map(function(e){return{text:e.name,value:e.name}}),value:e.name}}),e.data.section&&(e.sections=e.divisions.filter(function(t){return-1!==t.sections.findIndex(function(t){return t.text===e.data.section.text})}).map(function(e){return e.sections})[0]);case 5:case"end":return t.stop()}},t,e)}))()},validateFields:function(){console.log("res",this.$refs.form.validate()),this.$emit("extraInfoValid",this.$refs.form.validate())},resetValidation:function(){this.$refs.form.resetValidation()}},watch:{"data.division":function(e){var t=this.divisions.findIndex(function(t){return t.text===e.text});-1!==t&&(this.sections=this.divisions[t].sections)}}},G={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{attrs:{flat:e.flat}},[e.title?a("v-card-title",[a("div",{staticClass:"headline"},[e._v(e._s(e.title))]),e._v(" "),a("v-spacer")],1):e._e(),e._v(" "),e.title?a("v-divider"):e._e(),e._v(" "),a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Division")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-select",{attrs:{required:"",rules:e.rules,items:e.divisions,label:"Select","item-text":"text","item-value":"value","return-object":""},model:{value:e.data.division,callback:function(t){e.$set(e.data,"division",t)},expression:"data.division"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Section")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-select",{attrs:{required:"",rules:e.rules,items:e.sections,label:"Select","item-text":"text","item-value":"value","return-object":""},model:{value:e.data.section,callback:function(t){e.$set(e.data,"section",t)},expression:"data.section"}})],1)],1),e._v(" "),e.idNumberField?a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("ID Number")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{required:"",rules:e.rules},model:{value:e.data.emp_id,callback:function(t){e.$set(e.data,"emp_id",t)},expression:"data.emp_id"}})],1)],1):e._e(),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Position")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{required:"",rules:e.rules},model:{value:e.data.position,callback:function(t){e.$set(e.data,"position",t)},expression:"data.position"}})],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},H=a("VU/8")(F,G,!1,null,null,null).exports,j={data:function(){return{loading:!1,extra_information:{},loaderDialog:!1,divisions:[],sections:[]}},created:function(){this.extra_information=N()({},this.employee_data.extra_information),console.log(this.extra_information)},methods:{test:function(e){console.log(e)},save:function(){var e=this,t=JSON.parse(g()(this.extra_information));delete t.division.sections,this.loaderDialog=!0,this.$store.dispatch("account/UPDATE_INFORMATION",{field:"extra_information",data:t}).then(function(t){console.log(t),e.loaderDialog=!1,e.$snotify.success("Personal information updated")}).catch(function(t){console.log(t),e.loaderDialog=!1,e.$snotify.error("An error occurred")})}},computed:i()({},Object(U.b)({employee_data:"account/GET_EMPLOYEE_DATA"})),components:{ExtraInformation:H,LoaderDialog:T}},Y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:"",xl9:""}},[a("v-card",[a("ExtraInformation",{ref:"extraInfo",attrs:{data:e.extra_information,flat:!0,idNumberField:!1,title:"Extra Information"},on:{extraInfoValid:e.test}}),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.save()}}},[e._v("Save")])],1)],1)],1)],1)],1),e._v(" "),a("LoaderDialog",{attrs:{loaderDialog:e.loaderDialog}}),e._v(" "),a("vue-snotify")],1)},staticRenderFns:[]};var J=a("VU/8")(j,Y,!1,function(e){a("Poe2")},"data-v-582d01e4",null).exports,W=a("BcvJ"),z=(f.a.service("divisions"),{data:function(){return{valid:!0,loading:!1,loaderDialog:!1,password:{new:null,confirm:null},passwordRules:[function(e){return!!e||"This field is required"},function(e){var t=new W;return t.is().min(10).is().max(100).has().uppercase().has().lowercase().has().digits(2).has().not().spaces().has().symbols().is().not().oneOf(["Passw0rd","Password123","P@ssw0rd123"]),t.validate(e)||"Password must contain at least 10 characters, one uppercase letter, 1 numbers, and one special character"}],pwordPrependIcon:!0,confirmPrependIcon:!0}},methods:{save:function(){var e=this;return l()(n.a.mark(function t(){var a,r,s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((a=new W).is().min(10).is().max(100).has().uppercase().has().lowercase().has().digits(1).has().not().spaces().has().symbols().is().not().oneOf(["Passw0rd","Password123","P@ssw0rd123"]),r=a.validate(e.password.new&&e.password.confirm),e.password.new===e.password.confirm){t.next=6;break}return e.$snotify.error("Passwords did not match"),t.abrupt("return");case 6:if(e.$refs.form.validate()){t.next=8;break}return t.abrupt("return");case 8:if(e.loaderDialog=!0,t.prev=9,r){t.next=16;break}return e.loaderDialog=!1,e.$snotify.error("Password does not meet the complexity requirements."),t.abrupt("return");case 16:return t.next=18,e.$store.dispatch("account/UPDATE_INFORMATION",{field:"password",data:e.password.new});case 18:return s=t.sent,t.next=21,f.a.service("users").patch(s._id,{requirePasswordChange:!1});case 21:e.loaderDialog=!1,e.$snotify.success("Password has been successfully updated");case 23:t.next=30;break;case 25:t.prev=25,t.t0=t.catch(9),console.log(t.t0),e.loaderDialog=!1,e.$snotify.error("An error occurred");case 30:case"end":return t.stop()}},t,e,[[9,25]])}))()}}}),B={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:"",xl9:""}},[a("v-card",[a("v-card-title",[a("div",{staticClass:"headline white--text"},[e._v("Update Password")]),e._v(" "),a("v-spacer")],1),e._v(" "),a("v-divider"),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("New Password")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{"append-icon":e.pwordPrependIcon?"visibility":"visibility_off",type:e.pwordPrependIcon?"password":"text",required:"",rules:e.passwordRules},on:{"click:append":function(t){e.pwordPrependIcon=!e.pwordPrependIcon}},model:{value:e.password.new,callback:function(t){e.$set(e.password,"new",t)},expression:"password.new"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Confirm Password")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{"append-icon":e.confirmPrependIcon?"visibility":"visibility_off",type:e.confirmPrependIcon?"password":"text",required:"",rules:e.passwordRules},on:{"click:append":function(t){e.confirmPrependIcon=!e.confirmPrependIcon}},model:{value:e.password.confirm,callback:function(t){e.$set(e.password,"confirm",t)},expression:"password.confirm"}})],1)],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:e.save}},[e._v("Save")])],1)],1)],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:e.loaderDialog,callback:function(t){e.loaderDialog=t},expression:"loaderDialog"}},[a("v-card",{attrs:{color:"primary",dark:""}},[a("v-card-text",[e._v("\n\t\t\t\tPlease stand by\n\t\t\t\t"),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),e._v(" "),a("vue-snotify")],1)},staticRenderFns:[]};var K=a("VU/8")(z,B,!1,function(e){a("qFLw")},"data-v-35ccf626",null).exports;var Q={data:function(){return{valid:!0,loading:!1,loaderDialog:!1,roles:null,rolesRules:[function(e){return e&&function(e){try{var t=JSON.parse(e);return b()(t).length>0}catch(e){return!1}}(e)||"Invalid string. Data can't be parsed."}]}},created:function(){this.fetchInformation()},methods:{fetchInformation:function(){var e=this;this.$store.dispatch("account/GET_INFORMATION").then(function(t){t.roles&&(e.roles=g()(t.roles))}).catch(function(e){console.log(e)})},save:function(){var e=this;this.$refs.form.validate()&&(this.loaderDialog=!0,this.$store.dispatch("account/UPDATE_INFORMATION",{field:"roles",data:JSON.parse(this.roles)}).then(function(t){e.loaderDialog=!1,e.$snotify.success("Roles has been successfully updated")}).catch(function(t){console.log(t),e.loaderDialog=!1,e.$snotify.error("An error occurred")}))}},watch:{roles:function(e){try{this.roles=g()(JSON.parse(e),null,2)}catch(e){}}}},X={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:"",xl9:""}},[a("v-card",[a("v-card-title",{staticClass:"info"},[a("div",{staticClass:"headline white--text"},[e._v("Roles")]),e._v(" "),a("v-spacer")],1),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[e._v("Metadata")])],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{rules:e.rolesRules,rows:"15"},model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}})],1)],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:e.save}},[e._v("Save")])],1)],1)],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:e.loaderDialog,callback:function(t){e.loaderDialog=t},expression:"loaderDialog"}},[a("v-card",{attrs:{color:"primary",dark:""}},[a("v-card-text",[e._v("\n\t          Please stand by\n\t          "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),e._v(" "),a("vue-snotify")],1)},staticRenderFns:[]},Z=a("VU/8")(Q,X,!1,null,null,null).exports,ee={data:function(){return{step:1,personal_information:{},extra_information:{},loaderDialog:!1}},components:{PersonalInformation:L,ExtraInformation:H,LoaderDialog:T},methods:{save:function(){var e=this;return l()(n.a.mark(function t(){var a,r,s,i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loaderDialog=!0,t.prev=1,delete(a=JSON.parse(g()(e.extra_information))).division.sections,t.prev=4,t.next=7,e.$store.dispatch("account/CHECK_ID_NUMBER",a.emp_id);case 7:if(r=t.sent,console.log("Search result",r),!r.exists){t.next=13;break}return e.$snotify.error("ID Number already exists!"),e.loaderDialog=!1,t.abrupt("return");case 13:t.next=21;break;case 15:return t.prev=15,t.t0=t.catch(4),console.log(t.t0),e.$snotify.error("An error occurred"),e.loaderDialog=!1,t.abrupt("return");case 21:return(s=a.emp_id).length<=5&&(s="mirdc"+s),i={email:a.emp_id+"@mail.com",password:s,emp_id:a.emp_id,personal_information:e.personal_information,extra_information:a},t.next=26,e.$store.dispatch("account/SAVE_EMPLOYEE",i);case 26:e.personal_information={},e.extra_information={},e.$refs.personalInfo.resetValidation(),e.$refs.extraInfo.resetValidation(),e.step=1,e.$snotify.success("New user has been successfully added!"),t.next=38;break;case 34:t.prev=34,t.t1=t.catch(1),console.log(t.t1),e.$snotify.error("An error occurred");case 38:e.loaderDialog=!1;case 39:case"end":return t.stop()}},t,e,[[1,34],[4,15]])}))()}}},te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:"",xl9:""}},[a("v-stepper",{model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:e.step>1,step:"1"}},[e._v("Personal Information")]),e._v(" "),a("v-divider"),e._v(" "),a("v-stepper-step",{attrs:{complete:e.step>2,step:"2"}},[e._v("Extra Information")])],1),e._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-card",[a("PersonalInformation",{ref:"personalInfo",attrs:{data:e.personal_information,flat:!0},on:{personalInfoValid:function(t){return e.step=t?2:1}}}),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.$refs.personalInfo.validateFields()}}},[e._v("Next")])],1)],1)],1),e._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-card",[a("ExtraInformation",{ref:"extraInfo",attrs:{data:e.extra_information,flat:!0,idNumberField:!0},on:{extraInfoValid:function(t){return t?e.save():null}}}),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.step=1}}},[e._v("Back")]),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.$refs.extraInfo.validateFields()}}},[e._v("Save")])],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),a("LoaderDialog",{attrs:{loaderDialog:e.loaderDialog}}),e._v(" "),a("vue-snotify")],1)},staticRenderFns:[]},ae=a("VU/8")(ee,te,!1,null,null,null).exports,re={data:function(){return{loading:!1,loaderDialog:!1}},created:function(){},methods:{save:function(){var e=this;return l()(n.a.mark(function t(){var a,r,s,i,o,l,c,d;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((a=e.$refs.file.files).length){t.next=4;break}return e.$snotify.error("No file chosen"),t.abrupt("return");case 4:return e.loaderDialog=!0,t.prev=5,t.next=8,y(a[0]);case 8:return r=t.sent,t.next=11,E(r);case 11:return s=t.sent,i=k(s.width,s.height),o=i.width,l=i.height,t.next=15,I(r,o,l);case 15:return c=t.sent,(d=JSON.parse(g()(e.account.extra_information))).signature=c,t.next=20,e.$store.dispatch("account/UPDATE_INFORMATION",{field:"extra_information",data:d});case 20:e.$snotify.success("E-Signature has been successfully uploaded"),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(5),console.log(t.t0);case 26:e.loaderDialog=!1;case 27:case"end":return t.stop()}},t,e,[[5,23]])}))()}},computed:{account:function(){return this.$store.getters["account/GET_EMPLOYEE_DATA"]}},components:{LoaderDialog:T}},ne={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:"",sm12:"",md12:"",lg12:"",xl9:""}},[a("v-card",[a("v-card-title",{staticClass:"info"},[a("div",{staticClass:"headline white--text"},[e._v("Signature")]),e._v(" "),a("v-spacer")],1),e._v(" "),a("v-card-text",[e.account.extra_information.signature?a("v-avatar",{attrs:{size:"200",tile:""}},[a("v-img",{attrs:{src:e.account.extra_information.signature}},[a("v-layout",{attrs:{slot:"placeholder","fill-height":"","align-center":"","justify-center":"","ma-0":""},slot:"placeholder"},[a("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)],1)],1):e._e(),e._v(" "),a("div",{staticClass:"my-3"}),e._v(" "),a("input",{ref:"file",attrs:{type:"file"}})],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:e.save}},[e._v("Upload")])],1)],1)],1)],1)],1),e._v(" "),a("LoaderDialog",{attrs:{loaderDialog:e.loaderDialog}}),e._v(" "),a("vue-snotify")],1)},staticRenderFns:[]};var se=a("VU/8")(re,ne,!1,function(e){a("DmgS")},"data-v-88293032",null).exports,ie=a("2aIq"),oe=a.n(ie),le={namespaced:!0,state:{employee_data:{},isAuthenticated:!1,requirePasswordChange:!1},getters:{GET_EMPLOYEE_DATA:function(e){return e.employee_data}},mutations:{SET_EMPLOYEE_DATA:function(e,t){e.employee_data=t},SET_AUTHENTICATED:function(e,t){e.isAuthenticated=t},SET_REQUIRE_PASSWORD_CHANGE:function(e,t){e.requirePasswordChange=t}},actions:{LOGIN:function(e,t){var a=this,r=e.commit;return l()(n.a.mark(function e(){var s,i,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=t.idNumber+"@mail.com",e.next=4,f.a.authenticate({strategy:"local",email:s,password:t.password});case 4:return i=e.sent,e.next=7,f.a.passport.verifyJWT(i.accessToken);case 7:return o=e.sent,e.next=10,f.a.service("users").get(o.userId);case 10:return l=e.sent,console.log(l),r("SET_AUTHENTICATED",!0),r("SET_EMPLOYEE_DATA",l),e.abrupt("return",{userId:o.userId,userData:l});case 17:throw e.prev=17,e.t0=e.catch(0),e.t0;case 20:case"end":return e.stop()}},e,a,[[0,17]])}))()},GET_INFORMATION:function(e){var t=this;return oe()(e),l()(n.a.mark(function e(){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.authenticate();case 3:return a=e.sent.accessToken,e.next=6,f.a.passport.verifyJWT(a);case 6:return r=e.sent,e.next=9,f.a.service("users").get(r.userId);case 9:return e.abrupt("return",e.sent);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}},e,t,[[0,12]])}))()},UPDATE_INFORMATION:function(e,t){var a=this,r=e.commit,s=t.field,i=t.data,o=t.userId;return l()(n.a.mark(function e(){var t,l,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t={})[s]=i,e.next=5,f.a.authenticate();case 5:return l=e.sent.accessToken,e.next=8,f.a.passport.verifyJWT(l);case 8:return c=e.sent,r("SET_EMPLOYEE_DATA",t),o||(o=c.userId),e.next=13,f.a.service("users").patch(o,t);case 13:return e.abrupt("return",e.sent);case 16:throw e.prev=16,e.t0=e.catch(0),e.t0;case 19:case"end":return e.stop()}},e,a,[[0,16]])}))()},SAVE_EMPLOYEE:function(e,t){var a=this,r=e.commit;return l()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.service("users").create(t);case 2:return s=e.sent,r("employee/ADD_TO_LIST",s,{root:!0}),e.abrupt("return",s);case 5:case"end":return e.stop()}},e,a)}))()},CHECK_AUTHENTICATION:function(e){var t=this,a=e.commit;return l()(n.a.mark(function e(){var r,s,i,o,l,c;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=localStorage.getItem("sso-jwt"))){e.next=11;break}return e.next=5,f.a.passport.verifyJWT(r);case 5:return s=e.sent,e.next=8,f.a.service("users").get(s.userId);case 8:return i=e.sent,console.log("User",i),e.abrupt("return");case 11:return e.next=13,f.a.authenticate();case 13:return o=e.sent.accessToken,e.next=16,f.a.passport.verifyJWT(o);case 16:return l=e.sent.userId,e.next=19,f.a.service("users").get(l);case 19:return c=e.sent,a("SET_AUTHENTICATED",!0),a("SET_EMPLOYEE_DATA",c),e.abrupt("return",c);case 25:throw e.prev=25,e.t0=e.catch(0),e.t0;case 28:case"end":return e.stop()}},e,t,[[0,25]])}))()},CHECK_ID_NUMBER:function(e,t){var a=this;return oe()(e),l()(n.a.mark(function e(){var r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.service("users").find({query:{emp_id:t}});case 3:return r=e.sent,e.abrupt("return",{exists:r.data.length>0,data:r.data});case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},e,a,[[0,7]])}))()}}},ce={namespaced:!0,state:{},getters:{},mutations:{},actions:{GET_DIVISIONS:function(e){return oe()(e),f.a.service("divisions").find({query:{$paginate:{value:!1}}})}}},de={namespaced:!0,state:{list:[],isLoaded:!1},mutations:{SET_LIST:function(e,t){e.list=t},SET_IS_LOADED:function(e,t){e.isLoaded=t},ADD_TO_LIST:function(e,t){e.list.push(t)}},actions:{GET_EMPLOYEES:function(e){var t=this,a=e.state,r=e.commit;return l()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.isLoaded){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,f.a.service("users").find({query:{$paginate:{value:!1}}});case 5:s=e.sent,r("SET_LIST",s),r("SET_IS_LOADED",!0),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("Error loading employees"),console.log(e.t0);case 14:case"end":return e.stop()}},e,t,[[2,10]])}))()}}};c.default.use(U.a);var ue=new U.a.Store({modules:{account:le,division:ce,employee:de}}),ve=this;c.default.use(d.a);var fe,pe=new d.a({routes:[{path:"/",name:"Login",component:h},{path:"/employees",name:"Employees",component:O,meta:{layout:"employee",requiresPasswordCheck:!0}},{path:"/profile",name:"Profile",component:V,meta:{layout:"employee",requiresPasswordCheck:!0}},{path:"/extra-information",name:"ExtraInformation",component:J,meta:{layout:"employee",requiresPasswordCheck:!0}},{path:"/update-password",name:"UpdatePassword",component:K,meta:{layout:"employee"}},{path:"/roles",name:"Roles",component:Z,meta:{layout:"employee",requiresPasswordCheck:!0}},{path:"/new-employee",name:"NewEmployee",component:ae,meta:{layout:"employee",requiresPasswordCheck:!0}},{path:"/signature",name:"Signature",component:se,meta:{layout:"employee",requiresPasswordCheck:!0}}]});function me(){try{return window.self!==window.top}catch(e){return!0}}pe.beforeEach((fe=l()(n.a.mark(function e(t,a,r){var s,i,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=ue.state.account,i=s.isAuthenticated,o=s.employee_data,!me()){e.next=4;break}return i?window.parent.postMessage({action:"LOGIN",success:!0,user:o,token:localStorage.getItem("feathers-jwt")},"*"):window.parent.postMessage({action:"LOGIN",success:!1},"*"),e.abrupt("return");case 4:if(!i){e.next=26;break}if(l=t.matched.some(function(e){return e.meta.requiresPasswordCheck}),!o.requirePasswordChange||!l){e.next=12;break}if(!window.confirm("Oops! Looks like your password does not meet complexity requirements. Click OK to continue.")){e.next=11;break}return r({path:"/update-password"}),e.abrupt("return");case 11:return e.abrupt("return");case 12:if("/"!==t.path){e.next=16;break}r({path:"/profile"}),e.next=24;break;case 16:if("/logout"!==t.path||!t.query.continue){e.next=23;break}return e.next=19,f.a.logout();case 19:ue.commit("account/SET_AUTHENTICATED",!1),location.replace(t.query.continue),e.next=24;break;case 23:r();case 24:e.next=27;break;case 26:"/"!==t.path?r({path:"/"}):r();case 27:case"end":return e.stop()}},e,ve)})),function(e,t,a){return fe.apply(this,arguments)}));var _e=pe,he=a("3EgV"),xe=a.n(he),ge=(a("7zck"),a("c4So")),we=a("cTzj"),be=a.n(we),ye=a("OjAt"),Ee=a.n(ye),ke=a("HgYs"),Ie=(a("2d5O"),a("1I9z")),De=function(){var e=l()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Pe){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,ue.dispatch("account/CHECK_AUTHENTICATION");case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log("Not authenticated");case 10:Pe=new c.default(i()({el:"#app",store:ue,router:_e},ge.layout));case 11:case"end":return e.stop()}},e,this,[[2,7]])}));return function(){return e.apply(this,arguments)}}();c.default.use(xe.a),c.default.use(ge.VueExtendLayout),c.default.use(be.a,{silent:!0}),c.default.use(Ee.a),c.default.use(ke.b,{toast:{position:ke.a.rightTop,timeout:3e3}}),c.default.directive("mask",Ie.a),c.default.config.productionTip=!1;var Pe=void 0;De(),f.b.on("LOG_OUT",function(e){window.parent.postMessage({action:"LOG_OUT",userId:e},"*")})},Poe2:function(e,t){},Yekr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),s=a("+vOg"),i=a("NYxO"),o="SSO_THEME";var l={name:"employee",data:function(){return{dialog:!1,drawer:null,items:[{icon:"account_circle",text:"Profile",url:"Profile"},{icon:"assignment",text:"Extra Information",url:"ExtraInformation"},{icon:"lock",text:"Update Password",url:"UpdatePassword"}],isDark:"dark"===(e=localStorage.getItem(o),void 0!==e?e:"light")};var e},computed:n()({},Object(i.b)({employee_data:"account/GET_EMPLOYEE_DATA"})),created:function(){this.employee_data.roles&&this.employee_data.roles.sso&&this.employee_data.roles.sso.includes("admin")&&(this.items.unshift({divider:!0}),this.items.unshift({icon:"person_add",text:"New Employee",url:"NewEmployee"}),this.items.unshift({icon:"people",text:"Employees",url:"Employees"}))},methods:{logout:function(){var e=this;s.a.logout().then(function(){e.$store.commit("account/SET_AUTHENTICATED",!1),e.$store.commit("account/SET_EMPLOYEE_DATA",{}),e.$store.commit("account/SET_REQUIRE_PASSWORD_CHANGE",!1),e.$router.push({name:"Login"})})}},props:{source:String},watch:{isDark:function(e){localStorage.setItem(o,e?"dark":"light")}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{dark:e.isDark}},[a("v-navigation-drawer",{attrs:{fixed:"",clipped:e.$vuetify.breakpoint.mdAndUp,app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("v-list",{attrs:{dense:""}},[e._l(e.items,function(t,r){return[t.heading?a("v-layout",{key:t.heading,attrs:{row:"","align-center":""}},[a("v-flex",{attrs:{xs6:""}},[t.heading?a("v-subheader",[e._v(e._s(t.heading))]):e._e()],1),e._v(" "),a("v-flex",{staticClass:"text-xs-center",attrs:{xs6:""}},[a("a",{staticClass:"body-2 black--text",attrs:{href:"#!"}},[e._v("EDIT")])])],1):t.divider?a("v-divider",{key:r,staticClass:"my-3",attrs:{dark:""}}):t.children?a("v-list-group",{key:t.text,attrs:{"prepend-icon":t.model?t.icon:t["icon-alt"],"append-icon":""},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}},[a("v-list-tile",{attrs:{slot:"activator"},slot:"activator"},[a("v-list-tile-content",[a("v-list-tile-title",[e._v(e._s(t.text))])],1)],1),e._v(" "),e._l(t.children,function(t,r){return a("v-list-tile",{key:r},[t.icon?a("v-list-tile-action",[a("v-icon",[e._v(e._s(t.icon))])],1):e._e(),e._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[e._v(e._s(t.text))])],1)],1)})],2):a("v-list-tile",{key:t.text,attrs:{to:{name:t.url},ripple:""}},[a("v-list-tile-action",[a("v-icon",[e._v(e._s(t.icon))])],1),e._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[e._v(e._s(t.text))])],1)],1)]})],2)],1),e._v(" "),a("v-toolbar",{attrs:{app:"","clipped-left":e.$vuetify.breakpoint.mdAndUp,fixed:""}},[a("v-toolbar-title",{staticClass:"ml-0 pl-3",staticStyle:{width:"300px"}},[a("v-toolbar-side-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),e._v(" "),a("span",{staticClass:"hidden-sm-and-down"},[e._v("SSO Management")])],1),e._v(" "),a("v-spacer"),e._v(" "),a("v-btn",{attrs:{icon:"",title:"Switch theme"},on:{click:function(t){e.isDark=!e.isDark}}},[a("v-icon",[e._v(e._s(e.isDark?"nights_stay":"wb_sunny"))])],1),e._v(" "),a("v-btn",{attrs:{icon:"",title:"Log out"},on:{click:e.logout}},[a("v-icon",[e._v("exit_to_app")])],1)],1),e._v(" "),a("v-content",[a("router-view")],1)],1)},staticRenderFns:[]},d=a("VU/8")(l,c,!1,null,null,null);t.default=d.exports},cL48:function(e,t){},d2Vq:function(e,t){},kDKJ:function(e,t,a){var r={"./admin.vue":"7Ts1","./default.vue":"lfHO","./employee.vue":"Yekr"};function n(e){return a(s(e))}function s(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}n.keys=function(){return Object.keys(r)},n.resolve=s,e.exports=n,n.id="kDKJ"},lfHO:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-app",{attrs:{id:"inspire"}},[t("v-content",[t("router-view")],1)],1)},staticRenderFns:[]};var n=a("VU/8")({name:"default"},r,!1,function(e){a("d2Vq")},null,null);t.default=n.exports},qFLw:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.84a158781c8a8f40a24f.js.map